#AVL树


###Defination


之所以有AVL🌲是为了解决BST🌲可能出现的问题，考虑最坏的插入情况，BST 🌲可能退化为linked list,而AVL树因为不断的有一个rebalance的过程，左右孩子的高度差最多是差1


```
| hleft - hright | <= 1

```


然后来考察一颗高度为h的AVL树的最少节点数：

```

			A                  A
		  /   \      or      /   \
		h-2   h-1          h-1   h-2
		       •            •
		       
		
n(h) = n (h-1) + n(h-2) + 1

```


上一个式子就是斐波那契数列的变体

h = O(logn)
所以 对给定结点数为n的AVL树的最大高度为O(logn)


###性质



因为是Tree，所以大部分针对树的性质/算法应该都是通用的。

当然但是，又因为其是AVL树所以还是有其特殊的旋转insert之性质（旋转，跳跃）.....

本来想勇敢一次来改写一个C implement的AVL，让其变成C++，但是是我勇敢了太久....真的好难....


####Insertion

所以直写写吧，插入相对来说比较简单，因为插入之前是由AVL property的，插入之后最多高度相差2，然后有几种状况


```
| hleft - hright | = 2


case 1:  						case 2:
			
      36                       17
     /             23            \              23
    23     ->    /    \           23   ->      /  \
   /            17    36           \          17  36
  17                               36
   right rotation?                 left rotation?
   

case 3 :						case 4:		
    
     23                           23
     /                              \
   17 								 36		
     \								 /	
     18 							30
	
  			double rorations will solve  	 
     
```

下面两种情况先rotate一次，变成一条直线（case1/2），然后再rotate一次，最终应该能成功解决问题，所以也就是传说中的double rotations.

double rotations就是传说中的的LR/RL rotation.

当然这里没有考虑有子树的状况，但是相对来说子树就是顺着rotate去了某个方向了...

如果count L/R/LR/RL 算一次rotation，那么我相信insertion是一次rotation就够了


####Deleteion



但是对于deletion，破坏balance factor是从下到上的，所以一个rotation可能完全不够

consider this tree:

                 50
              /      \
            25       75
           /   \    /   \
          15   40  60    80
               /  /  \    \
              35 55  65   90
                     /
                    62
                    
delete 15 , first the 25's balance factor is destructed, one rotation:

                 50
              /      \
            35       75
           /  \    /   \
          25  40  60    80
                  /  \    \
                 55  65   90
                     /
                    62
                    
                    
but still, we have to check, now the tree's root's balance factor is destructed, have to be rotated again:


                 60
              /      \
            50       75
           /   \     /  \
          35   55   65   80
         /  \       /     \
        25  40     62     90




同时，我也好奇当我真正需要用AVL Tree/真正会写它是哪一天|||| 




